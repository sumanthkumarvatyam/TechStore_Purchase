<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shopping Cart - TechStore</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <header>
        <nav class="navbar">
            <div class="container">
                <div class="nav-brand">
                    <h1>TechStore</h1>
                </div>
                <ul class="nav-menu">
                    <li><a href="index.html">Home</a></li>
                    <li><a href="products.html">Products</a></li>
                    <li><a href="cart.html" class="active">Cart <span id="cart-count" class="cart-badge">0</span></a></li>
                </ul>
            </div>
        </nav>
    </header>

    <section class="cart-section">
        <div class="container">
            <h2>Shopping Cart</h2>
            
            <div id="empty-cart" class="empty-cart" style="display: none;">
                <p>Your cart is empty</p>
                <a href="products.html" class="btn btn-primary">Continue Shopping</a>
            </div>

            <div id="cart-content">
                <div class="cart-items" id="cart-items">
                    <!-- Cart items will be loaded here -->
                </div>

                <div class="cart-summary">
                    <h3>Order Summary</h3>
                    <div class="summary-row">
                        <span>Subtotal:</span>
                        <span id="subtotal">$0.00</span>
                    </div>
                    <div class="summary-row">
                        <span>Tax (10%):</span>
                        <span id="tax">$0.00</span>
                    </div>
                    <div class="summary-row">
                        <span>Shipping:</span>
                        <span id="shipping">$9.99</span>
                    </div>
                    <hr>
                    <div class="summary-row total">
                        <span><strong>Total:</strong></span>
                        <span id="total"><strong>$0.00</strong></span>
                    </div>
                    <button id="purchase-btn" class="btn btn-success btn-block">Purchase</button>
                </div>
            </div>
        </div>
    </section>

    <!-- Purchase Success Modal -->
    <div id="purchase-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Order Confirmed!</h2>
            </div>
            <div class="modal-body">
                <div class="success-icon">✓</div>
                <p>Thank you for your purchase!</p>
                <p>Order Number: <strong id="order-number"></strong></p>
                <p>Total Amount: <strong id="order-total"></strong></p>
                <p>A confirmation email has been sent to your email address.</p>
            </div>
            <div class="modal-footer">
                <button id="continue-shopping" class="btn btn-primary">Continue Shopping</button>
            </div>
        </div>
    </div>

    <footer>
        <div class="container">
            <p>&copy; 2026 TechStore. All rights reserved.</p>
        </div>
    </footer>

    <script src="script.js"></script>
    <script>
        // Load cart items
        document.addEventListener('DOMContentLoaded', function() {
            loadCartItems();
            updateCartCount();
            
            // Purchase button click handler
            document.getElementById('purchase-btn').addEventListener('click', handlePurchase);
            
            // Continue shopping button
            document.getElementById('continue-shopping').addEventListener('click', function() {
                document.getElementById('purchase-modal').style.display = 'none';
                window.location.href = 'products.html';
            });
        });

        function loadCartItems() {
            const cart = getCart();
            const cartItemsContainer = document.getElementById('cart-items');
            const emptyCart = document.getElementById('empty-cart');
            const cartContent = document.getElementById('cart-content');
            
            if (cart.length === 0) {
                emptyCart.style.display = 'block';
                cartContent.style.display = 'none';
                return;
            }
            
            emptyCart.style.display = 'none';
            cartContent.style.display = 'flex';
            cartItemsContainer.innerHTML = '';
            
            cart.forEach(item => {
                const cartItem = createCartItemElement(item);
                cartItemsContainer.appendChild(cartItem);
            });
            
            updateCartSummary();
        }

        function createCartItemElement(item) {
            const div = document.createElement('div');
            div.className = 'cart-item';
            div.innerHTML = `
                <div class="cart-item-image">
                    <img src="${item.image}" alt="${item.name}">
                </div>
                <div class="cart-item-details">
                    <h3>${item.name}</h3>
                    <p class="cart-item-price">$${item.price.toFixed(2)}</p>
                </div>
                <div class="cart-item-quantity">
                    <button class="qty-btn" onclick="updateQuantity(${item.id}, -1)">-</button>
                    <span class="quantity">${item.quantity}</span>
                    <button class="qty-btn" onclick="updateQuantity(${item.id}, 1)">+</button>
                </div>
                <div class="cart-item-total">
                    <p>$${(item.price * item.quantity).toFixed(2)}</p>
                </div>
                <button class="remove-btn" onclick="removeFromCart(${item.id})">×</button>
            `;
            return div;
        }

        function updateQuantity(productId, change) {
            let cart = getCart();
            const item = cart.find(i => i.id === productId);
            
            if (item) {
                item.quantity += change;
                if (item.quantity <= 0) {
                    cart = cart.filter(i => i.id !== productId);
                }
                saveCart(cart);
                loadCartItems();
                updateCartCount();
            }
        }

        function removeFromCart(productId) {
            let cart = getCart();
            cart = cart.filter(i => i.id !== productId);
            saveCart(cart);
            loadCartItems();
            updateCartCount();
        }

        function updateCartSummary() {
            const cart = getCart();
            const subtotal = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            const tax = subtotal * 0.10;
            const shipping = subtotal > 0 ? 9.99 : 0;
            const total = subtotal + tax + shipping;
            
            document.getElementById('subtotal').textContent = `$${subtotal.toFixed(2)}`;
            document.getElementById('tax').textContent = `$${tax.toFixed(2)}`;
            document.getElementById('shipping').textContent = subtotal > 0 ? `$${shipping.toFixed(2)}` : '$0.00';
            document.getElementById('total').textContent = `$${total.toFixed(2)}`;
        }

        function handlePurchase() {
            const cart = getCart();
            
            if (cart.length === 0) {
                alert('Your cart is empty!');
                return;
            }
            
            // Calculate total
            const subtotal = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            const tax = subtotal * 0.10;
            const shipping = 9.99;
            const total = subtotal + tax + shipping;
            
            // Generate order number
            const orderNumber = 'ORD-' + Date.now();
            
            // Show success modal
            document.getElementById('order-number').textContent = orderNumber;
            document.getElementById('order-total').textContent = `$${total.toFixed(2)}`;
            document.getElementById('purchase-modal').style.display = 'flex';
            
            // Clear cart
            localStorage.removeItem('cart');
            
            // Update cart display (will happen when modal closes)
            setTimeout(() => {
                loadCartItems();
                updateCartCount();
            }, 100);
        }
    </script>
</body>
</html>
